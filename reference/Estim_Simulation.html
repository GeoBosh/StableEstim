<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Monte Carlo simulation — Estim_Simulation • StableEstim</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Monte Carlo simulation — Estim_Simulation"><meta name="description" content="Runs Monte Carlo simulation for a selected estimation method. The
  function can save a file and produce a statistical summary."><meta property="og:description" content="Runs Monte Carlo simulation for a selected estimation method. The
  function can save a file and produce a statistical summary."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">StableEstim</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/GeoBosh/StableEstim/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Monte Carlo simulation</h1>

      <div class="d-none name"><code>Estim_Simulation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Runs Monte Carlo simulation for a selected estimation method. The
  function can save a file and produce a statistical summary.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Estim_Simulation</span><span class="op">(</span>AlphaBetaMatrix <span class="op">=</span> <span class="va">abMat</span>, SampleSizes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">1600</span><span class="op">)</span>,</span>
<span>                 MCparam <span class="op">=</span> <span class="fl">100</span>, Estimfct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ML"</span>, <span class="st">"GMM"</span>, <span class="st">"Cgmm"</span>,<span class="st">"Kout"</span><span class="op">)</span>,</span>
<span>                 HandleError <span class="op">=</span> <span class="cn">TRUE</span>, FctsToApply <span class="op">=</span> <span class="va">StatFcts</span>,</span>
<span>                 saveOutput <span class="op">=</span> <span class="cn">TRUE</span>, StatSummary <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                 CheckMat <span class="op">=</span> <span class="cn">TRUE</span>, tolFailCheck <span class="op">=</span> <span class="va">tolFailure</span>,</span>
<span>                 SeedOptions<span class="op">=</span><span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-alphabetamatrix">AlphaBetaMatrix<a class="anchor" aria-label="anchor" href="#arg-alphabetamatrix"></a></dt>
<dd><p>values of the parameter \(\alpha\) and \(\beta\) from which we
    simulate the data. By default, the values of \(\gamma\) and
    \(\delta\) are set to 1 and 0, respectively;
    a \(2 \times n\) matrix.</p></dd>

  <dt id="arg-samplesizes">SampleSizes<a class="anchor" aria-label="anchor" href="#arg-samplesizes"></a></dt>
<dd><p>sample sizes to be used to simulate the data. By default, we use
    <code>200</code> (small sample size) and <code>1600</code> (large sample size);
    vector of integers.</p></dd>

  <dt id="arg-mcparam">MCparam<a class="anchor" aria-label="anchor" href="#arg-mcparam"></a></dt>
<dd><p>Number of Monte Carlo simulation for each couple of parameter,
    default = 100; an integer number.</p></dd>

  <dt id="arg-estimfct">Estimfct<a class="anchor" aria-label="anchor" href="#arg-estimfct"></a></dt>
<dd><p>the estimation function to be used, one of
    <code>"ML"</code>, <code>"GMM"</code>, <code>"Cgmm"</code> or <code>"Kout"</code>.</p></dd>

  <dt id="arg-handleerror">HandleError<a class="anchor" aria-label="anchor" href="#arg-handleerror"></a></dt>
<dd><p>logical flag: if set to TRUE, the simulation doesn't stop when an
    error in the estimation function is encountered. A vector of (size
    4) <code>NA</code> is saved and the the simulation carries on. See
    details.</p></dd>

  <dt id="arg-fctstoapply">FctsToApply<a class="anchor" aria-label="anchor" href="#arg-fctstoapply"></a></dt>
<dd><p>functions used to produce the statistical summary. See details;
    a character vector.</p></dd>

  <dt id="arg-saveoutput">saveOutput<a class="anchor" aria-label="anchor" href="#arg-saveoutput"></a></dt>
<dd><p>logical flag: if set to TRUE, a csv file (for each couple of
    parameters \(\alpha\) and \(\beta\)) with the the estimation
    information is saved in the current directory. See Details.</p></dd>

  <dt id="arg-statsummary">StatSummary<a class="anchor" aria-label="anchor" href="#arg-statsummary"></a></dt>
<dd><p>logical flag: if set to TRUE, a statistical summary (using
    <code>FctsToApply</code>) is returned. See Details.</p></dd>

  <dt id="arg-checkmat">CheckMat<a class="anchor" aria-label="anchor" href="#arg-checkmat"></a></dt>
<dd><p>logical flag: if set to TRUE, an estimation is declared failed if
    the squared error of the estimation is larger than
    <code>tolFailCheck</code>; default = TRUE.</p></dd>

  <dt id="arg-tolfailcheck">tolFailCheck<a class="anchor" aria-label="anchor" href="#arg-tolfailcheck"></a></dt>
<dd><p>tolerance on the squared error of the estimation to be declared
    failed; default = 1.5.</p></dd>

  <dt id="arg-seedoptions">SeedOptions<a class="anchor" aria-label="anchor" href="#arg-seedoptions"></a></dt>
<dd><p>list to control the seed generation. See Details.</p></dd>

  <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments to be passed to the estimation function.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><!-- %\cr\cr -->
  <b>Error Handling</b>
  <!-- %\cr\cr -->
  It is advisable to set it to TRUE when the user is planning to launch
  long simulations as it will prevent the procedure from stopping if an
  error occurs for one sample data. The estimation function will produce
  a vector of <code>NA</code> as estimated parameters related to this (error
  generating) sample data and move on to the next Monte Carlo step.
  <!-- %\cr\cr -->
  <b>Statistical summary</b>
  <!-- %\cr\cr -->
  The function is able to produce a statistical summary of the Monte
  Carlo simulation for each parameter (slices of the list). Each slice
  is a matrix where the rows represents the true values of the
  parameters and the columns the statistical information.
  <!-- %\cr\cr -->
  In all cases, the following quantities are computed:</p><dl><dt><code>sample size</code>:</dt>
<dd><p>the sample size used to produce the simulated data.</p></dd>

    <dt><code>alphaT</code>, <code>betaT</code>:</dt>
<dd><p>the true values of the parameters.</p></dd>

    <dt><code>failure</code>:</dt>
<dd><p>the number of times the procedure failed to produce relevant
      estimation.</p></dd>

    <dt><code>time</code>:</dt>
<dd><p>the average running time in seconds of the estimation procedure</p></dd>


</dl><p>Besides, the (vector of <code>character</code>) <code>FctsToApply</code> controls
  the other quantities to be computed by providing the name of the
  function object to be applied to the vector of estimated
  parameters. The signature of the function should be of the form
  <code>fctName = function(p,...){...}</code>, where <code>p</code> is the vector
  (<code>length(p) = MCparam</code>) of parameter estimates and <code>...</code>
  is the extra arguments to be passed the function.</p>
<p>By default, the functions from <code>StatFcts</code> will be applied but the
  user can pass his own functions by providing their names in argument
  <code>FctsToApply</code> and their definitions in the global environment.</p>
<p>Note that if <code>CheckMat</code> is set to TRUE, the estimation is
  considered failed if the squared error (of the first 2 parameters
  <code>alpha</code> and <code>beta</code>) is larger than <code>tolFailCheck</code>.</p>
<p><b>Output file</b></p>
<p>Setting <code>saveOutput</code> to TRUE will have the side effect of saving
  a csv file in the working directory. This file will have
  <code>MCparam * length(SampleSizes)</code> lines and its columns will
  be:</p><dl><dt><code>alphaT</code>, <code>betaT</code>:</dt>
<dd><p>the true values of the parameters.</p></dd>

    <dt><code>data size</code>:</dt>
<dd><p>the sample size used to generate the simulated data.</p></dd>

    <dt><code>seed</code>:</dt>
<dd><p>the seed value used to generate the simulated data.</p></dd>

    <dt><code>alphaE</code>, <code>betaE</code>, <code>gammaE</code>, <code>deltaE</code>:</dt>
<dd><p>the estimates of the 4 parameters.</p></dd>

    <dt><code>failure</code>:</dt>
<dd><p>binary: 0 for success, 1 for failure.</p></dd>

    <dt><code>time</code>:</dt>
<dd><p>estimation running time in seconds.</p></dd>


</dl><p>The file name is informative to let the user identify the values of
  the true parameters, the MC parameters, as well as the options
  selected for the estimation method.</p>
<p>The csv file is updated after each MC estimation, which is useful when
  the simulation stops before it finishes. Besides, using the
  check-pointing mechanism explained below, the simulation can re-start
  from where it stopped.</p>
<p><em>Check-pointing.</em>
  Checkpointing is the act of saving enough program state and results so
  far calculated that a computation can be stopped and restarted. The
  way we did it here is to save a text file with some useful information
  about the state of the estimation. This text file is updated after
  each MC iteration and read at the beginning of function
  <code>Estim_Simulation</code> to allow the simulation to re-start from where
  it stopped. This file is deleted at the end of the simulation
  procedure.</p>
<p><em>SeedOptions.</em>
  Users who do not want to control the seed generation can ignore this
  argument (its default value is <code>NULL</code>). This argument can be more
  useful when one wants to cut the simulation (even for one parameter
  value) into pieces. In that case, the user can control which part of
  the seed vector to use.</p><dl><dt><code>MCtot</code>:</dt>
<dd><p>total values of MC simulations in the entire process.</p></dd>

    <dt><code>seedStart</code>:</dt>
<dd><p>starting index in the seed vector. The vector extracted will be of
      size <code>MCparam</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>StatSummary</code> is set to TRUE, a <code>list</code> with 4 components
  (corresponding to the 4 parameters) is returned. Each component is a
  matrix. If <code>SaveOutput</code> is set to TRUE, only a csv file is saved
  and nothing is returned (if <code>StatSummary</code> is FALSE).  If both are
  FALSE, the function stops.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Estim.html">Estim</a></code>,
  <code><a href="CgmmParamsEstim.html">CgmmParametersEstim</a></code>,
  <code><a href="GMMParametersEstim.html">GMMParametersEstim</a></code>,
  <code><a href="MLParametersEstim.html">MLParametersEstim</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tarak Kharrat, Georgi N. Boshnakov.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

